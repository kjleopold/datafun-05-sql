2025-02-11 21:18:21.750 | INFO     | __main__:<module>:41 - Logging to file: logs\project_log.log
2025-02-11 21:18:21.751 | INFO     | __main__:main:63 - STARTING utils_logger.py
2025-02-11 21:18:21.751 | INFO     | __main__:log_example:54 - This is an example info message.
2025-02-11 21:18:21.751 | WARNING  | __main__:log_example:55 - This is an example warning message.
2025-02-11 21:18:21.752 | ERROR    | __main__:log_example:56 - This is an example error message.
2025-02-11 21:18:21.752 | INFO     | __main__:main:68 - View the log output at logs\project_log.log
2025-02-11 21:18:21.753 | INFO     | __main__:main:69 - EXITING utils_logger.py.
2025-02-11 21:18:52.465 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-11 21:18:52.465 | INFO     | __main__:main:38 - Starting database setup...
2025-02-11 21:18:52.467 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-11 21:18:52.468 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\01_drop_tables.sql
2025-02-11 21:18:52.473 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\02_create_tables.sql
2025-02-11 21:18:52.476 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\03_insert_records.sql
2025-02-11 21:18:52.476 | INFO     | __main__:main:60 - Database setup completed successfully.
2025-02-11 21:18:52.477 | INFO     | __main__:main:65 - Database connection closed.
2025-02-11 21:19:07.137 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-11 21:19:07.138 | INFO     | __main__:main:36 - Starting feature queries execution...
2025-02-11 21:19:07.139 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-11 21:19:07.140 | INFO     | __main__:execute_sql_file:27 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-11 21:19:07.140 | INFO     | __main__:execute_sql_file:27 - Executed: C:\Projects\datafun-05-sql\sql_features\update_records.sql
2025-02-11 21:19:07.140 | INFO     | __main__:main:58 - Feature queries execution completed successfully.
2025-02-11 21:19:07.140 | INFO     | __main__:main:63 - Database connection closed.
2025-02-11 22:01:06.625 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-11 22:01:06.625 | INFO     | __main__:main:38 - Starting database setup...
2025-02-11 22:01:06.626 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-11 22:01:06.626 | ERROR    | __main__:execute_sql_file:32 - Failed to execute C:\Projects\datafun-05-sql\sql_create\01_drop_tables.sql: [Errno 2] No such file or directory: 'C:\\Projects\\datafun-05-sql\\sql_create\\01_drop_tables.sql'
2025-02-11 22:01:06.626 | ERROR    | __main__:main:62 - Error during database setup: [Errno 2] No such file or directory: 'C:\\Projects\\datafun-05-sql\\sql_create\\01_drop_tables.sql'
2025-02-11 22:01:06.627 | INFO     | __main__:main:65 - Database connection closed.
2025-02-11 22:04:06.933 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-11 22:04:06.933 | INFO     | __main__:main:38 - Starting database setup...
2025-02-11 22:04:06.935 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-11 22:04:06.935 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\01_drop_tables.sql
2025-02-11 22:04:06.936 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\02_create_tables.sql
2025-02-11 22:04:06.936 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\03_insert_records.sql
2025-02-11 22:04:06.936 | INFO     | __main__:main:60 - Database setup completed successfully.
2025-02-11 22:04:06.937 | INFO     | __main__:main:65 - Database connection closed.
2025-02-11 22:22:27.484 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-11 22:22:27.485 | INFO     | __main__:main:36 - Starting feature queries execution...
2025-02-11 22:22:27.486 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-11 22:22:27.487 | INFO     | __main__:main:58 - Feature queries execution completed successfully.
2025-02-11 22:22:27.487 | INFO     | __main__:main:63 - Database connection closed.
2025-02-11 22:44:23.821 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-11 22:44:23.822 | INFO     | __main__:main:38 - Starting database setup...
2025-02-11 22:44:23.823 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-11 22:44:23.824 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\01_drop_tables.sql
2025-02-11 22:44:23.827 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\02_create_tables.sql
2025-02-11 22:44:23.830 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\03_insert_records.sql
2025-02-11 22:44:23.831 | INFO     | __main__:main:60 - Database setup completed successfully.
2025-02-11 22:44:23.831 | INFO     | __main__:main:65 - Database connection closed.
2025-02-11 22:46:51.712 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-11 22:46:51.713 | INFO     | __main__:main:36 - Starting feature queries execution...
2025-02-11 22:46:51.713 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-11 22:46:51.714 | INFO     | __main__:main:58 - Feature queries execution completed successfully.
2025-02-11 22:46:51.714 | INFO     | __main__:main:63 - Database connection closed.
2025-02-12 17:52:40.681 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-12 17:52:40.682 | INFO     | __main__:main:38 - Starting database setup...
2025-02-12 17:52:40.684 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-12 17:52:40.689 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\01_drop_tables.sql
2025-02-12 17:52:40.692 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\02_create_tables.sql
2025-02-12 17:52:40.694 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\03_insert_records.sql
2025-02-12 17:52:40.694 | INFO     | __main__:main:60 - Database setup completed successfully.
2025-02-12 17:52:40.694 | INFO     | __main__:main:65 - Database connection closed.
2025-02-12 17:52:57.676 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-12 17:52:57.676 | INFO     | __main__:main:36 - Starting feature queries execution...
2025-02-12 17:52:57.677 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-12 17:52:57.679 | INFO     | __main__:execute_sql_file:27 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-12 17:52:57.679 | INFO     | __main__:execute_sql_file:27 - Executed: C:\Projects\datafun-05-sql\sql_features\update_records.sql
2025-02-12 17:52:57.679 | INFO     | __main__:main:58 - Feature queries execution completed successfully.
2025-02-12 17:52:57.680 | INFO     | __main__:main:63 - Database connection closed.
2025-02-12 19:26:01.322 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-12 19:26:01.322 | INFO     | __main__:main:38 - Starting database setup...
2025-02-12 19:26:01.324 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-12 19:26:01.328 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\01_drop_tables.sql
2025-02-12 19:26:01.332 | INFO     | __main__:execute_sql_file:30 - Executed: C:\Projects\datafun-05-sql\sql_create\02_create_tables.sql
2025-02-12 19:26:01.334 | ERROR    | __main__:execute_sql_file:32 - Failed to execute C:\Projects\datafun-05-sql\sql_create\03_insert_records.sql: unrecognized token: "'16f3e0a1-24cb-4ed6-a50"
2025-02-12 19:26:01.334 | ERROR    | __main__:main:62 - Error during database setup: unrecognized token: "'16f3e0a1-24cb-4ed6-a50"
2025-02-12 19:26:01.335 | INFO     | __main__:main:65 - Database connection closed.
2025-02-18 11:45:40.497 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 11:45:40.497 | INFO     | __main__:main:56 - Database operation started.
2025-02-18 11:45:40.504 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 11:45:40.508 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 11:45:40.527 | INFO     | __main__:insert_data_from_csv:45 - Data inserted successfully.
2025-02-18 11:45:40.527 | INFO     | __main__:main:59 - Database operation completed.
2025-02-18 12:01:51.694 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:01:51.694 | INFO     | __main__:main:36 - Starting feature queries execution...
2025-02-18 12:01:51.694 | INFO     | __main__:main:52 - Connected to database: C:\Projects\datafun-05-sql\data\db.sqlite
2025-02-18 12:01:51.704 | INFO     | __main__:execute_sql_file:27 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 12:01:51.710 | INFO     | __main__:execute_sql_file:27 - Executed: C:\Projects\datafun-05-sql\sql_features\update_records.sql
2025-02-18 12:01:51.710 | INFO     | __main__:main:58 - Feature queries execution completed successfully.
2025-02-18 12:01:51.710 | INFO     | __main__:main:63 - Database connection closed.
2025-02-18 12:02:42.316 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:02:42.316 | INFO     | __main__:main:56 - Database operation started.
2025-02-18 12:02:42.320 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 12:02:42.325 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 12:02:42.340 | INFO     | __main__:insert_data_from_csv:45 - Data inserted successfully.
2025-02-18 12:02:42.341 | INFO     | __main__:main:59 - Database operation completed.
2025-02-18 12:10:10.021 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:10:10.021 | INFO     | __main__:main:36 - Starting feature queries execution...
2025-02-18 12:11:30.924 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:11:30.924 | INFO     | __main__:main:36 - Starting feature queries execution...
2025-02-18 12:11:30.924 | INFO     | __main__:main:51 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 12:11:30.928 | INFO     | __main__:execute_sql_file:27 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 12:11:30.938 | ERROR    | __main__:execute_sql_file:29 - Failed to execute C:\Projects\datafun-05-sql\sql_features\update_records.sql: table authors has no column named first_name
2025-02-18 12:11:30.938 | ERROR    | __main__:main:59 - Error during feature queries execution: table authors has no column named first_name
2025-02-18 12:11:30.938 | INFO     | __main__:main:62 - Database connection closed.
2025-02-18 12:12:28.287 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:12:28.287 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 12:12:28.288 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 12:12:28.289 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 12:12:28.289 | ERROR    | __main__:execute_sql_file:30 - SQLite error in C:\Projects\datafun-05-sql\sql_features\update_records.sql: duplicate column name: genre
2025-02-18 12:12:28.289 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 12:12:28.289 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 12:18:16.659 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:18:16.659 | INFO     | __main__:main:56 - Database operation started.
2025-02-18 12:18:16.663 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 12:18:16.668 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 12:18:16.683 | INFO     | __main__:insert_data_from_csv:45 - Data inserted successfully.
2025-02-18 12:18:16.683 | INFO     | __main__:main:59 - Database operation completed.
2025-02-18 12:42:02.470 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:42:02.470 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 12:42:02.471 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 12:42:02.474 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 12:42:02.477 | ERROR    | __main__:execute_sql_file:30 - SQLite error in C:\Projects\datafun-05-sql\sql_features\update_records.sql: table authors has no column named first_name
2025-02-18 12:42:02.477 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 12:42:02.477 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 12:43:26.902 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:43:26.902 | INFO     | __main__:main:56 - Database operation started.
2025-02-18 12:43:26.906 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 12:43:26.911 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 12:43:26.931 | INFO     | __main__:insert_data_from_csv:45 - Data inserted successfully.
2025-02-18 12:43:26.931 | INFO     | __main__:main:59 - Database operation completed.
2025-02-18 12:45:03.966 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:45:03.967 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 12:45:03.967 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 12:45:03.971 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 12:45:03.972 | ERROR    | __main__:execute_sql_file:30 - SQLite error in C:\Projects\datafun-05-sql\sql_features\update_records.sql: table authors has no column named year_born
2025-02-18 12:45:03.973 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 12:45:03.973 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 12:50:41.217 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:50:41.217 | INFO     | __main__:main:49 - Database operation started.
2025-02-18 12:50:41.221 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 12:50:41.226 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 12:51:12.833 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:51:12.834 | INFO     | __main__:main:49 - Database operation started.
2025-02-18 12:51:12.838 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 12:51:12.843 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 12:51:12.852 | INFO     | __main__:insert_data:40 - Data inserted successfully.
2025-02-18 12:51:12.852 | INFO     | __main__:main:52 - Database operation completed.
2025-02-18 12:51:36.590 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 12:51:36.590 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 12:51:36.590 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 12:51:36.595 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 12:51:36.604 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\update_records.sql
2025-02-18 12:51:36.604 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 12:51:36.605 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 13:01:02.148 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 13:01:02.149 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 13:01:02.149 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 13:01:02.150 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 13:01:02.156 | ERROR    | __main__:execute_sql_file:30 - SQLite error in C:\Projects\datafun-05-sql\sql_features\update_records.sql: duplicate column name: genre
2025-02-18 13:01:02.157 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 13:01:02.157 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 13:03:05.182 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 13:03:05.182 | INFO     | __main__:main:49 - Database operation started.
2025-02-18 13:03:05.186 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 13:03:05.190 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 13:03:05.195 | INFO     | __main__:insert_data:40 - Data inserted successfully.
2025-02-18 13:03:05.195 | INFO     | __main__:main:52 - Database operation completed.
2025-02-18 13:03:30.875 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 13:03:30.875 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 13:03:30.876 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 13:03:30.879 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 13:03:30.899 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\update_records.sql
2025-02-18 13:03:30.900 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 13:03:30.900 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 13:06:27.780 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 13:06:27.780 | INFO     | __main__:main:49 - Database operation started.
2025-02-18 13:06:27.785 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 13:06:27.790 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 13:06:27.794 | INFO     | __main__:insert_data:40 - Data inserted successfully.
2025-02-18 13:06:27.794 | INFO     | __main__:main:52 - Database operation completed.
2025-02-18 13:06:34.176 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 13:06:34.176 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 13:06:34.177 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 13:06:34.181 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 13:06:34.207 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\update_records.sql
2025-02-18 13:06:34.207 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 13:06:34.207 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 13:07:48.991 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 13:07:48.991 | INFO     | __main__:main:49 - Database operation started.
2025-02-18 13:07:48.995 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 13:07:49.000 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 13:07:49.004 | INFO     | __main__:insert_data:40 - Data inserted successfully.
2025-02-18 13:07:49.004 | INFO     | __main__:main:52 - Database operation completed.
2025-02-18 13:07:55.657 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 13:07:55.657 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 13:07:55.659 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 13:07:55.669 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 13:07:55.688 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\update_records.sql
2025-02-18 13:07:55.689 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 13:07:55.689 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 14:01:28.755 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:01:28.756 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_aggregation.sql
2025-02-18 14:01:28.761 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:01:28.762 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:01:28.767 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_books
0           21

2025-02-18 14:01:28.767 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:01:28.768 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:02:59.084 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:02:59.084 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:02:59.085 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:03:12.645 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:03:12.645 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:03:12.646 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:03:12.647 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_authors
0             10

2025-02-18 14:03:12.647 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_filter.sql
2025-02-18 14:03:12.648 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter books published after the year 2000
SELECT title, year_published
FROM books
WHERE year_published > 2000
ORDER BY year_published
2025-02-18 14:03:12.649 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:03:12.651 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                       title  year_published
0  Harry Potter and the Order of the Pheonix            2003
1     Harry Potter and the Half-Blood Prince            2005
2                                   Twilight            2005
3                                   New Moon            2006
4       Harry Potter and the Deathly Hallows            2007
5                                    Eclipse            2007
6                              Breaking Dawn            2008
7                               Midnight Sun            2020

2025-02-18 14:03:12.652 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:03:12.653 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:03:17.315 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:03:17.315 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_group_by.sql
2025-02-18 14:03:17.321 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Group books by author and count books by genre
SELECT a.first_name, a.last_name, g.genre_name, COUNT(b.book_id) AS books_count
FROM authors a
JOIN books b ON a.author_id = b.author_id
JOIN genres g ON b.genre_id = g.genre_id
GROUP BY a.author_id, g.genre_id
ORDER BY books_count DESC
2025-02-18 14:03:17.322 | ERROR    | __main__:execute_sql_query:29 - Unexpected error: Execution failed on sql '-- Group books by author and count books by genre
SELECT a.first_name, a.last_name, g.genre_name, COUNT(b.book_id) AS books_count
FROM authors a
JOIN books b ON a.author_id = b.author_id
JOIN genres g ON b.genre_id = g.genre_id
GROUP BY a.author_id, g.genre_id
ORDER BY books_count DESC': no such table: genres
2025-02-18 14:03:17.323 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_join.sql
2025-02-18 14:03:17.329 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books with their authors
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:03:17.331 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:03:17.334 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:03:17.334 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:03:17.335 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:03:17.339 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:03:17.339 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_sorting.sql
2025-02-18 14:03:17.344 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:03:17.346 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:03:17.347 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:03:17.348 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by year published
SELECT title, year_published
FROM books
ORDER BY year_published DESC
2025-02-18 14:03:17.349 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:03:17.350 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                                Midnight Sun            2020
1                               Breaking Dawn            2008
2        Harry Potter and the Deathly Hallows            2007
3                                     Eclipse            2007
4                                    New Moon            2006
5      Harry Potter and the Half-Blood Prince            2005
6                                    Twilight            2005
7   Harry Potter and the Order of the Pheonix            2003
8         Harry Potter and the Goblet of Fire            2000
9                                  Nightshade            2000
10   Harry Potter and the Prisoner of Azkaban            1999
11    Harry Potter and the Chamber of Secrets            1998
12      Harry Potter and the Sorcerer's Stone            1997
13                      To Kill a Mockingbird            1960
14                      The Lord of the Rings            1954
15                             Fahrenheit 451            1953
16                     The Catcher in the Rye            1951
17                                 The Hobbit            1937
18                            Brave New World            1932
19                           The Great Gatsby            1925
20                        Pride and Prejudice            1813

2025-02-18 14:03:17.350 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:03:17.351 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:03:17.353 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:11:39.806 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:11:39.806 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_aggregation.sql
2025-02-18 14:11:39.807 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:11:39.808 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:11:39.810 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_books
0           21

2025-02-18 14:11:39.810 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:11:39.811 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:11:39.811 | ERROR    | __main__:plot_query_results:70 - Error plotting results: 'year_published'
2025-02-18 14:11:39.813 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:11:39.813 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:11:39.814 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:11:39.814 | ERROR    | __main__:plot_query_results:70 - Error plotting results: 'year_published'
2025-02-18 14:11:39.817 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:11:39.817 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:11:39.818 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:11:39.819 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_authors
0             10

2025-02-18 14:11:39.819 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_filter.sql
2025-02-18 14:11:39.819 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter books published after the year 2000
SELECT title, year_published
FROM books
WHERE year_published > 2000
ORDER BY year_published
2025-02-18 14:11:39.820 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:11:39.821 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                       title  year_published
0  Harry Potter and the Order of the Pheonix            2003
1     Harry Potter and the Half-Blood Prince            2005
2                                   Twilight            2005
3                                   New Moon            2006
4       Harry Potter and the Deathly Hallows            2007
5                                    Eclipse            2007
6                              Breaking Dawn            2008
7                               Midnight Sun            2020

2025-02-18 14:11:39.821 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:11:39.822 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:11:39.822 | ERROR    | __main__:plot_query_results:70 - Error plotting results: 'year_published'
2025-02-18 14:11:39.824 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:11:39.824 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_group_by.sql
2025-02-18 14:11:39.830 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Group books by publication year
SELECT year_published, COUNT(*) AS total_books
FROM books
GROUP BY year_published
2025-02-18 14:11:39.831 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:14:22.172 | INFO     | __main__:execute_queries_from_files:53 - Query results:
    year_published  total_books
0             1813            1
1             1925            1
2             1932            1
3             1937            1
4             1951            1
5             1953            1
6             1954            1
7             1960            1
8             1997            1
9             1998            1
10            1999            1
11            2000            2
12            2003            1
13            2005            2
14            2006            1
15            2007            2
16            2008            1
17            2020            1

2025-02-18 14:14:22.173 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_join.sql
2025-02-18 14:14:22.173 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books with their authors
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:14:22.174 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:14:22.177 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:14:22.178 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:14:22.179 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:14:22.182 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:14:22.182 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_sorting.sql
2025-02-18 14:14:22.183 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:14:22.184 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:14:22.186 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:14:22.186 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by year published
SELECT title, year_published
FROM books
ORDER BY year_published DESC
2025-02-18 14:14:22.187 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:14:22.189 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                                Midnight Sun            2020
1                               Breaking Dawn            2008
2        Harry Potter and the Deathly Hallows            2007
3                                     Eclipse            2007
4                                    New Moon            2006
5      Harry Potter and the Half-Blood Prince            2005
6                                    Twilight            2005
7   Harry Potter and the Order of the Pheonix            2003
8         Harry Potter and the Goblet of Fire            2000
9                                  Nightshade            2000
10   Harry Potter and the Prisoner of Azkaban            1999
11    Harry Potter and the Chamber of Secrets            1998
12      Harry Potter and the Sorcerer's Stone            1997
13                      To Kill a Mockingbird            1960
14                      The Lord of the Rings            1954
15                             Fahrenheit 451            1953
16                     The Catcher in the Rye            1951
17                                 The Hobbit            1937
18                            Brave New World            1932
19                           The Great Gatsby            1925
20                        Pride and Prejudice            1813

2025-02-18 14:14:22.189 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:14:22.190 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:14:22.192 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:16:26.312 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:16:26.312 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_aggregation.sql
2025-02-18 14:16:26.313 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:16:26.314 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:16:26.316 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_books
0           21

2025-02-18 14:16:26.316 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:16:26.317 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:16:26.317 | ERROR    | __main__:plot_query_results:63 - Insufficient data for plotting. Missing required columns.
2025-02-18 14:16:26.319 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:16:26.319 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:16:26.320 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:16:26.320 | ERROR    | __main__:plot_query_results:63 - Insufficient data for plotting. Missing required columns.
2025-02-18 14:16:26.323 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:16:26.324 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:16:26.324 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:16:26.325 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_authors
0             10

2025-02-18 14:16:26.325 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_filter.sql
2025-02-18 14:16:26.326 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter books published after the year 2000
SELECT title, year_published
FROM books
WHERE year_published > 2000
ORDER BY year_published
2025-02-18 14:16:26.326 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:16:26.327 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                       title  year_published
0  Harry Potter and the Order of the Pheonix            2003
1     Harry Potter and the Half-Blood Prince            2005
2                                   Twilight            2005
3                                   New Moon            2006
4       Harry Potter and the Deathly Hallows            2007
5                                    Eclipse            2007
6                              Breaking Dawn            2008
7                               Midnight Sun            2020

2025-02-18 14:16:26.328 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:16:26.328 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:16:26.329 | ERROR    | __main__:plot_query_results:63 - Insufficient data for plotting. Missing required columns.
2025-02-18 14:16:26.330 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:16:26.330 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_group_by.sql
2025-02-18 14:16:26.336 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Group books by publication year
SELECT year_published, COUNT(DISTINCT author_id) AS total_authors
FROM books
GROUP BY year_published
ORDER BY year_published
2025-02-18 14:16:26.337 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:37.164 | INFO     | __main__:execute_queries_from_files:53 - Query results:
    year_published  total_authors
0             1813              1
1             1925              1
2             1932              1
3             1937              1
4             1951              1
5             1953              1
6             1954              1
7             1960              1
8             1997              1
9             1998              1
10            1999              1
11            2000              2
12            2003              1
13            2005              2
14            2006              1
15            2007              2
16            2008              1
17            2020              1

2025-02-18 14:18:37.165 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_join.sql
2025-02-18 14:18:37.165 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books with their authors
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:18:37.166 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:37.170 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:18:37.170 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:18:37.172 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:37.175 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:18:37.175 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_sorting.sql
2025-02-18 14:18:37.175 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:18:37.176 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:37.179 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:18:37.180 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by year published
SELECT title, year_published
FROM books
ORDER BY year_published DESC
2025-02-18 14:18:37.181 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:37.184 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                                Midnight Sun            2020
1                               Breaking Dawn            2008
2        Harry Potter and the Deathly Hallows            2007
3                                     Eclipse            2007
4                                    New Moon            2006
5      Harry Potter and the Half-Blood Prince            2005
6                                    Twilight            2005
7   Harry Potter and the Order of the Pheonix            2003
8         Harry Potter and the Goblet of Fire            2000
9                                  Nightshade            2000
10   Harry Potter and the Prisoner of Azkaban            1999
11    Harry Potter and the Chamber of Secrets            1998
12      Harry Potter and the Sorcerer's Stone            1997
13                      To Kill a Mockingbird            1960
14                      The Lord of the Rings            1954
15                             Fahrenheit 451            1953
16                     The Catcher in the Rye            1951
17                                 The Hobbit            1937
18                            Brave New World            1932
19                           The Great Gatsby            1925
20                        Pride and Prejudice            1813

2025-02-18 14:18:37.184 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:18:37.185 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:37.189 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:18:52.105 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:18:52.106 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_aggregation.sql
2025-02-18 14:18:52.106 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:18:52.107 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:52.109 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_books
0           21

2025-02-18 14:18:52.109 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:18:52.110 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:52.110 | INFO     | __main__:plot_query_results:62 - DataFrame columns: Index(['first_name', 'last_name', 'total_books'], dtype='object')
2025-02-18 14:18:52.111 | INFO     | __main__:plot_query_results:63 - DataFrame head:
  first_name last_name  total_books
0       J.K.   Rowling            7
1  Stephenie     Meyer            5
2     J.R.R.   Tolkien            2
3        Ray  Bradbury            1
4     Harper       Lee            1
2025-02-18 14:18:52.111 | ERROR    | __main__:plot_query_results:67 - Insufficient data for plotting. Missing required columns.
2025-02-18 14:18:52.114 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:18:52.114 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:18:52.115 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:52.115 | INFO     | __main__:plot_query_results:62 - DataFrame columns: Index(['first_name', 'last_name', 'earliest_year', 'latest_year'], dtype='object')
2025-02-18 14:18:52.118 | INFO     | __main__:plot_query_results:63 - DataFrame head:
  first_name last_name  earliest_year  latest_year
0  Stephenie     Meyer         2005.0       2020.0
1       J.K.   Rowling         1997.0       2007.0
2     Harper       Lee         1960.0       1960.0
3     J.R.R.   Tolkien         1937.0       1954.0
4        Ray  Bradbury         1953.0       1953.0
2025-02-18 14:18:52.118 | ERROR    | __main__:plot_query_results:67 - Insufficient data for plotting. Missing required columns.
2025-02-18 14:18:52.120 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:18:52.121 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:18:52.121 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:52.122 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_authors
0             10

2025-02-18 14:18:52.123 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_filter.sql
2025-02-18 14:18:52.123 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter books published after the year 2000
SELECT title, year_published
FROM books
WHERE year_published > 2000
ORDER BY year_published
2025-02-18 14:18:52.124 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:52.125 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                       title  year_published
0  Harry Potter and the Order of the Pheonix            2003
1     Harry Potter and the Half-Blood Prince            2005
2                                   Twilight            2005
3                                   New Moon            2006
4       Harry Potter and the Deathly Hallows            2007
5                                    Eclipse            2007
6                              Breaking Dawn            2008
7                               Midnight Sun            2020

2025-02-18 14:18:52.125 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:18:52.126 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:52.126 | INFO     | __main__:plot_query_results:62 - DataFrame columns: Index(['first_name', 'last_name', 'total_books'], dtype='object')
2025-02-18 14:18:52.128 | INFO     | __main__:plot_query_results:63 - DataFrame head:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5
2025-02-18 14:18:52.128 | ERROR    | __main__:plot_query_results:67 - Insufficient data for plotting. Missing required columns.
2025-02-18 14:18:52.130 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:18:52.130 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_group_by.sql
2025-02-18 14:18:52.131 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Group books by publication year
SELECT year_published, COUNT(DISTINCT author_id) AS total_authors
FROM books
GROUP BY year_published
ORDER BY year_published
2025-02-18 14:18:52.132 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:18:52.132 | INFO     | __main__:plot_query_results:62 - DataFrame columns: Index(['year_published', 'total_authors'], dtype='object')
2025-02-18 14:18:52.133 | INFO     | __main__:plot_query_results:63 - DataFrame head:
   year_published  total_authors
0            1813              1
1            1925              1
2            1932              1
3            1937              1
4            1951              1
2025-02-18 14:20:40.157 | INFO     | __main__:execute_queries_from_files:53 - Query results:
    year_published  total_authors
0             1813              1
1             1925              1
2             1932              1
3             1937              1
4             1951              1
5             1953              1
6             1954              1
7             1960              1
8             1997              1
9             1998              1
10            1999              1
11            2000              2
12            2003              1
13            2005              2
14            2006              1
15            2007              2
16            2008              1
17            2020              1

2025-02-18 14:20:40.157 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_join.sql
2025-02-18 14:20:40.158 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books with their authors
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:20:40.159 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:40.163 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:20:40.163 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:20:40.165 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:40.167 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:20:40.168 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_sorting.sql
2025-02-18 14:20:40.168 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:20:40.169 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:40.171 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:20:40.172 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by year published
SELECT title, year_published
FROM books
ORDER BY year_published DESC
2025-02-18 14:20:40.172 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:40.174 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                                Midnight Sun            2020
1                               Breaking Dawn            2008
2        Harry Potter and the Deathly Hallows            2007
3                                     Eclipse            2007
4                                    New Moon            2006
5      Harry Potter and the Half-Blood Prince            2005
6                                    Twilight            2005
7   Harry Potter and the Order of the Pheonix            2003
8         Harry Potter and the Goblet of Fire            2000
9                                  Nightshade            2000
10   Harry Potter and the Prisoner of Azkaban            1999
11    Harry Potter and the Chamber of Secrets            1998
12      Harry Potter and the Sorcerer's Stone            1997
13                      To Kill a Mockingbird            1960
14                      The Lord of the Rings            1954
15                             Fahrenheit 451            1953
16                     The Catcher in the Rye            1951
17                                 The Hobbit            1937
18                            Brave New World            1932
19                           The Great Gatsby            1925
20                        Pride and Prejudice            1813

2025-02-18 14:20:40.175 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:20:40.176 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:40.178 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:20:59.280 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:20:59.280 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_aggregation.sql
2025-02-18 14:20:59.280 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:20:59.281 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.283 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_books
0           21

2025-02-18 14:20:59.283 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:20:59.284 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.284 | INFO     | __main__:plot_query_results:62 - DataFrame columns: Index(['first_name', 'last_name', 'total_books'], dtype='object')
2025-02-18 14:20:59.286 | INFO     | __main__:plot_query_results:63 - DataFrame head:
  first_name last_name  total_books
0       J.K.   Rowling            7
1  Stephenie     Meyer            5
2     J.R.R.   Tolkien            2
3        Ray  Bradbury            1
4     Harper       Lee            1
2025-02-18 14:20:59.286 | ERROR    | __main__:plot_query_results:67 - Insufficient data for plotting. Missing required columns.
2025-02-18 14:20:59.288 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:20:59.288 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:20:59.289 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.289 | INFO     | __main__:plot_query_results:62 - DataFrame columns: Index(['first_name', 'last_name', 'earliest_year', 'latest_year'], dtype='object')
2025-02-18 14:20:59.292 | INFO     | __main__:plot_query_results:63 - DataFrame head:
  first_name last_name  earliest_year  latest_year
0  Stephenie     Meyer         2005.0       2020.0
1       J.K.   Rowling         1997.0       2007.0
2     Harper       Lee         1960.0       1960.0
3     J.R.R.   Tolkien         1937.0       1954.0
4        Ray  Bradbury         1953.0       1953.0
2025-02-18 14:20:59.292 | ERROR    | __main__:plot_query_results:67 - Insufficient data for plotting. Missing required columns.
2025-02-18 14:20:59.295 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:20:59.295 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:20:59.296 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.297 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_authors
0             10

2025-02-18 14:20:59.297 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_filter.sql
2025-02-18 14:20:59.297 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter books published after the year 2000
SELECT title, year_published
FROM books
WHERE year_published > 2000
ORDER BY year_published
2025-02-18 14:20:59.298 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.299 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                       title  year_published
0  Harry Potter and the Order of the Pheonix            2003
1     Harry Potter and the Half-Blood Prince            2005
2                                   Twilight            2005
3                                   New Moon            2006
4       Harry Potter and the Deathly Hallows            2007
5                                    Eclipse            2007
6                              Breaking Dawn            2008
7                               Midnight Sun            2020

2025-02-18 14:20:59.300 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:20:59.300 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.301 | INFO     | __main__:plot_query_results:62 - DataFrame columns: Index(['first_name', 'last_name', 'total_books'], dtype='object')
2025-02-18 14:20:59.302 | INFO     | __main__:plot_query_results:63 - DataFrame head:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5
2025-02-18 14:20:59.302 | ERROR    | __main__:plot_query_results:67 - Insufficient data for plotting. Missing required columns.
2025-02-18 14:20:59.304 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:20:59.304 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_group_by.sql
2025-02-18 14:20:59.310 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Group books by publication year
SELECT year_published, COUNT(*) AS total_books
FROM books
GROUP BY year_published
ORDER BY year_published
2025-02-18 14:20:59.311 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.312 | INFO     | __main__:plot_query_results:62 - DataFrame columns: Index(['year_published', 'total_books'], dtype='object')
2025-02-18 14:20:59.313 | INFO     | __main__:plot_query_results:63 - DataFrame head:
   year_published  total_books
0            1813            1
1            1925            1
2            1932            1
3            1937            1
4            1951            1
2025-02-18 14:20:59.313 | ERROR    | __main__:plot_query_results:67 - Insufficient data for plotting. Missing required columns.
2025-02-18 14:20:59.315 | INFO     | __main__:execute_queries_from_files:53 - Query results:
    year_published  total_books
0             1813            1
1             1925            1
2             1932            1
3             1937            1
4             1951            1
5             1953            1
6             1954            1
7             1960            1
8             1997            1
9             1998            1
10            1999            1
11            2000            2
12            2003            1
13            2005            2
14            2006            1
15            2007            2
16            2008            1
17            2020            1

2025-02-18 14:20:59.315 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_join.sql
2025-02-18 14:20:59.315 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books with their authors
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:20:59.316 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.319 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:20:59.319 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:20:59.320 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.322 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:20:59.323 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_sorting.sql
2025-02-18 14:20:59.323 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:20:59.324 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.325 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:20:59.325 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by year published
SELECT title, year_published
FROM books
ORDER BY year_published DESC
2025-02-18 14:20:59.326 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.327 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                                Midnight Sun            2020
1                               Breaking Dawn            2008
2        Harry Potter and the Deathly Hallows            2007
3                                     Eclipse            2007
4                                    New Moon            2006
5      Harry Potter and the Half-Blood Prince            2005
6                                    Twilight            2005
7   Harry Potter and the Order of the Pheonix            2003
8         Harry Potter and the Goblet of Fire            2000
9                                  Nightshade            2000
10   Harry Potter and the Prisoner of Azkaban            1999
11    Harry Potter and the Chamber of Secrets            1998
12      Harry Potter and the Sorcerer's Stone            1997
13                      To Kill a Mockingbird            1960
14                      The Lord of the Rings            1954
15                             Fahrenheit 451            1953
16                     The Catcher in the Rye            1951
17                                 The Hobbit            1937
18                            Brave New World            1932
19                           The Great Gatsby            1925
20                        Pride and Prejudice            1813

2025-02-18 14:20:59.328 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:20:59.328 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:20:59.330 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:23:08.371 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:23:08.371 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_aggregation.sql
2025-02-18 14:23:08.371 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:23:08.373 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.375 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_books
0           21

2025-02-18 14:23:08.375 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:23:08.376 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.376 | ERROR    | __main__:plot_query_results:63 - Missing required columns for plotting.
2025-02-18 14:23:08.377 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:23:08.377 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:23:08.378 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.378 | ERROR    | __main__:plot_query_results:63 - Missing required columns for plotting.
2025-02-18 14:23:08.381 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:23:08.382 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:23:08.382 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.384 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_authors
0             10

2025-02-18 14:23:08.384 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_filter.sql
2025-02-18 14:23:08.384 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter books published after the year 2000
SELECT title, year_published
FROM books
WHERE year_published > 2000
ORDER BY year_published
2025-02-18 14:23:08.385 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.386 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                       title  year_published
0  Harry Potter and the Order of the Pheonix            2003
1     Harry Potter and the Half-Blood Prince            2005
2                                   Twilight            2005
3                                   New Moon            2006
4       Harry Potter and the Deathly Hallows            2007
5                                    Eclipse            2007
6                              Breaking Dawn            2008
7                               Midnight Sun            2020

2025-02-18 14:23:08.386 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:23:08.387 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.387 | ERROR    | __main__:plot_query_results:63 - Missing required columns for plotting.
2025-02-18 14:23:08.389 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:23:08.389 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_group_by.sql
2025-02-18 14:23:08.394 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Group books by author
SELECT authors.first_name || ' ' || authors.last_name AS author_name, 
       (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) AS total_books
FROM authors
HAVING total_books > 1
ORDER BY total_books DESC
2025-02-18 14:23:08.395 | ERROR    | __main__:execute_sql_query:29 - Unexpected error: Execution failed on sql '-- Group books by author
SELECT authors.first_name || ' ' || authors.last_name AS author_name, 
       (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) AS total_books
FROM authors
HAVING total_books > 1
ORDER BY total_books DESC': HAVING clause on a non-aggregate query
2025-02-18 14:23:08.396 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_join.sql
2025-02-18 14:23:08.396 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books with their authors
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:23:08.397 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.400 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:23:08.401 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:23:08.402 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.404 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:23:08.404 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_sorting.sql
2025-02-18 14:23:08.404 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:23:08.405 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.407 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:23:08.407 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by year published
SELECT title, year_published
FROM books
ORDER BY year_published DESC
2025-02-18 14:23:08.408 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.410 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                                Midnight Sun            2020
1                               Breaking Dawn            2008
2        Harry Potter and the Deathly Hallows            2007
3                                     Eclipse            2007
4                                    New Moon            2006
5      Harry Potter and the Half-Blood Prince            2005
6                                    Twilight            2005
7   Harry Potter and the Order of the Pheonix            2003
8         Harry Potter and the Goblet of Fire            2000
9                                  Nightshade            2000
10   Harry Potter and the Prisoner of Azkaban            1999
11    Harry Potter and the Chamber of Secrets            1998
12      Harry Potter and the Sorcerer's Stone            1997
13                      To Kill a Mockingbird            1960
14                      The Lord of the Rings            1954
15                             Fahrenheit 451            1953
16                     The Catcher in the Rye            1951
17                                 The Hobbit            1937
18                            Brave New World            1932
19                           The Great Gatsby            1925
20                        Pride and Prejudice            1813

2025-02-18 14:23:08.410 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:23:08.411 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:23:08.413 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:24:18.635 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:24:18.635 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_aggregation.sql
2025-02-18 14:24:18.635 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:24:18.637 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:24:18.639 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_books
0           21

2025-02-18 14:24:18.639 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:24:18.640 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:24:18.640 | ERROR    | __main__:plot_query_results:63 - Missing required columns for plotting.
2025-02-18 14:24:18.641 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:24:18.641 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:24:18.642 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:24:18.642 | ERROR    | __main__:plot_query_results:63 - Missing required columns for plotting.
2025-02-18 14:24:18.645 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:24:18.645 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:24:18.646 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:24:18.647 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_authors
0             10

2025-02-18 14:24:18.647 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_filter.sql
2025-02-18 14:24:18.648 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter books published after the year 2000
SELECT title, year_published
FROM books
WHERE year_published > 2000
ORDER BY year_published
2025-02-18 14:24:18.648 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:24:18.650 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                       title  year_published
0  Harry Potter and the Order of the Pheonix            2003
1     Harry Potter and the Half-Blood Prince            2005
2                                   Twilight            2005
3                                   New Moon            2006
4       Harry Potter and the Deathly Hallows            2007
5                                    Eclipse            2007
6                              Breaking Dawn            2008
7                               Midnight Sun            2020

2025-02-18 14:24:18.650 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:24:18.651 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:24:18.651 | ERROR    | __main__:plot_query_results:63 - Missing required columns for plotting.
2025-02-18 14:24:18.652 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:24:18.653 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_group_by.sql
2025-02-18 14:24:18.659 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Group books by author
SELECT authors.first_name || ' ' || authors.last_name AS author_name, 
       (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) AS total_books
FROM authors
WHERE (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) > 1
ORDER BY total_books DESC
2025-02-18 14:24:18.660 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:10.618 | INFO     | __main__:execute_queries_from_files:53 - Query results:
       author_name  total_books
0     J.K. Rowling            7
1  Stephenie Meyer            5
2   J.R.R. Tolkien            2

2025-02-18 14:25:10.619 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_join.sql
2025-02-18 14:25:10.619 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books with their authors
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:25:10.620 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:10.623 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:25:10.623 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:25:10.624 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:10.627 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:25:10.628 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_sorting.sql
2025-02-18 14:25:10.628 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:25:10.629 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:10.631 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:25:10.632 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by year published
SELECT title, year_published
FROM books
ORDER BY year_published DESC
2025-02-18 14:25:10.632 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:10.634 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                                Midnight Sun            2020
1                               Breaking Dawn            2008
2        Harry Potter and the Deathly Hallows            2007
3                                     Eclipse            2007
4                                    New Moon            2006
5      Harry Potter and the Half-Blood Prince            2005
6                                    Twilight            2005
7   Harry Potter and the Order of the Pheonix            2003
8         Harry Potter and the Goblet of Fire            2000
9                                  Nightshade            2000
10   Harry Potter and the Prisoner of Azkaban            1999
11    Harry Potter and the Chamber of Secrets            1998
12      Harry Potter and the Sorcerer's Stone            1997
13                      To Kill a Mockingbird            1960
14                      The Lord of the Rings            1954
15                             Fahrenheit 451            1953
16                     The Catcher in the Rye            1951
17                                 The Hobbit            1937
18                            Brave New World            1932
19                           The Great Gatsby            1925
20                        Pride and Prejudice            1813

2025-02-18 14:25:10.635 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:25:10.636 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:10.638 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:25:20.933 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:25:20.934 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_aggregation.sql
2025-02-18 14:25:20.934 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:25:20.935 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:20.937 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_books
0           21

2025-02-18 14:25:20.937 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:25:20.938 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:20.938 | ERROR    | __main__:plot_query_results:73 - Error plotting results: 'author_name'
2025-02-18 14:25:20.940 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:25:20.941 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:25:20.941 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:20.942 | ERROR    | __main__:plot_query_results:73 - Error plotting results: 'author_name'
2025-02-18 14:25:20.944 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:25:20.944 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:25:20.945 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:20.946 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   total_authors
0             10

2025-02-18 14:25:20.946 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_filter.sql
2025-02-18 14:25:20.947 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter books published after the year 2000
SELECT title, year_published
FROM books
WHERE year_published > 2000
ORDER BY year_published
2025-02-18 14:25:20.947 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:20.949 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                       title  year_published
0  Harry Potter and the Order of the Pheonix            2003
1     Harry Potter and the Half-Blood Prince            2005
2                                   Twilight            2005
3                                   New Moon            2006
4       Harry Potter and the Deathly Hallows            2007
5                                    Eclipse            2007
6                              Breaking Dawn            2008
7                               Midnight Sun            2020

2025-02-18 14:25:20.949 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:25:20.950 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:25:20.950 | ERROR    | __main__:plot_query_results:73 - Error plotting results: 'author_name'
2025-02-18 14:25:20.952 | INFO     | __main__:execute_queries_from_files:53 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:25:20.952 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_group_by.sql
2025-02-18 14:25:20.952 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Group books by author
SELECT authors.first_name || ' ' || authors.last_name AS author_name, 
       (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) AS total_books
FROM authors
WHERE (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) > 1
ORDER BY total_books DESC
2025-02-18 14:25:20.953 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:28:13.064 | INFO     | __main__:execute_queries_from_files:53 - Query results:
       author_name  total_books
0     J.K. Rowling            7
1  Stephenie Meyer            5
2   J.R.R. Tolkien            2

2025-02-18 14:28:13.064 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_join.sql
2025-02-18 14:28:13.064 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books with their authors
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:28:13.065 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:28:13.070 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:28:13.070 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:28:13.071 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:28:13.076 | INFO     | __main__:execute_queries_from_files:53 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:28:13.077 | INFO     | __main__:execute_queries_from_files:36 - Processing file: query_sorting.sql
2025-02-18 14:28:13.077 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:28:13.079 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:28:13.081 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:28:13.082 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by year published
SELECT title, year_published
FROM books
ORDER BY year_published DESC
2025-02-18 14:28:13.083 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:28:13.085 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title  year_published
0                                Midnight Sun            2020
1                               Breaking Dawn            2008
2        Harry Potter and the Deathly Hallows            2007
3                                     Eclipse            2007
4                                    New Moon            2006
5      Harry Potter and the Half-Blood Prince            2005
6                                    Twilight            2005
7   Harry Potter and the Order of the Pheonix            2003
8         Harry Potter and the Goblet of Fire            2000
9                                  Nightshade            2000
10   Harry Potter and the Prisoner of Azkaban            1999
11    Harry Potter and the Chamber of Secrets            1998
12      Harry Potter and the Sorcerer's Stone            1997
13                      To Kill a Mockingbird            1960
14                      The Lord of the Rings            1954
15                             Fahrenheit 451            1953
16                     The Catcher in the Rye            1951
17                                 The Hobbit            1937
18                            Brave New World            1932
19                           The Great Gatsby            1925
20                        Pride and Prejudice            1813

2025-02-18 14:28:13.086 | INFO     | __main__:execute_queries_from_files:45 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:28:13.087 | INFO     | __main__:execute_sql_query:22 - Query executed successfully.
2025-02-18 14:28:13.090 | INFO     | __main__:execute_queries_from_files:53 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:28:22.005 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:28:22.006 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 14:28:22.006 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:28:22.007 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.009 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 14:28:22.009 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:28:22.010 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.011 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:28:22.011 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:28:22.012 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.015 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:28:22.015 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:28:22.016 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.018 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_authors
0             10

2025-02-18 14:28:22.018 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 14:28:22.018 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter books published after the year 2000
SELECT title, year_published
FROM books
WHERE year_published > 2000
ORDER BY year_published
2025-02-18 14:28:22.019 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.020 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                       title  year_published
0  Harry Potter and the Order of the Pheonix            2003
1     Harry Potter and the Half-Blood Prince            2005
2                                   Twilight            2005
3                                   New Moon            2006
4       Harry Potter and the Deathly Hallows            2007
5                                    Eclipse            2007
6                              Breaking Dawn            2008
7                               Midnight Sun            2020

2025-02-18 14:28:22.020 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:28:22.021 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.023 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:28:22.023 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 14:28:22.023 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT authors.first_name || ' ' || authors.last_name AS author_name, 
       (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) AS total_books
FROM authors
WHERE (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) > 1
ORDER BY total_books DESC
2025-02-18 14:28:22.024 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.025 | INFO     | __main__:execute_queries_from_files:48 - Query results:
       author_name  total_books
0     J.K. Rowling            7
1  Stephenie Meyer            5
2   J.R.R. Tolkien            2

2025-02-18 14:28:22.025 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 14:28:22.026 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:28:22.027 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.029 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:28:22.030 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:28:22.031 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.034 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:28:22.035 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 14:28:22.035 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:28:22.036 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.038 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:28:22.039 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by year published
SELECT title, year_published
FROM books
ORDER BY year_published DESC
2025-02-18 14:28:22.040 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.041 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                                Midnight Sun            2020
1                               Breaking Dawn            2008
2        Harry Potter and the Deathly Hallows            2007
3                                     Eclipse            2007
4                                    New Moon            2006
5      Harry Potter and the Half-Blood Prince            2005
6                                    Twilight            2005
7   Harry Potter and the Order of the Pheonix            2003
8         Harry Potter and the Goblet of Fire            2000
9                                  Nightshade            2000
10   Harry Potter and the Prisoner of Azkaban            1999
11    Harry Potter and the Chamber of Secrets            1998
12      Harry Potter and the Sorcerer's Stone            1997
13                      To Kill a Mockingbird            1960
14                      The Lord of the Rings            1954
15                             Fahrenheit 451            1953
16                     The Catcher in the Rye            1951
17                                 The Hobbit            1937
18                            Brave New World            1932
19                           The Great Gatsby            1925
20                        Pride and Prejudice            1813

2025-02-18 14:28:22.041 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:28:22.042 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:28:22.044 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:30:43.077 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:30:43.077 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 14:30:43.077 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:30:43.078 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:30:43.080 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 14:30:43.081 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:30:43.081 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:30:43.083 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:30:43.083 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:30:43.084 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:30:43.087 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:30:43.087 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:30:43.088 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:30:43.089 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_authors
0             10

2025-02-18 14:30:43.089 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 14:30:43.095 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:30:43.096 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:30:43.098 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:30:43.098 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 14:30:43.098 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT authors.first_name || ' ' || authors.last_name AS author_name, 
       (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) AS total_books
FROM authors
WHERE (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) > 1
ORDER BY total_books DESC
2025-02-18 14:30:43.099 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:30:43.100 | INFO     | __main__:execute_queries_from_files:48 - Query results:
       author_name  total_books
0     J.K. Rowling            7
1  Stephenie Meyer            5
2   J.R.R. Tolkien            2

2025-02-18 14:30:43.100 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 14:30:43.101 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:30:43.102 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:30:43.105 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:30:43.105 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:30:43.106 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:30:43.108 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:30:43.109 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 14:30:43.114 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:30:43.115 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:30:43.116 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:30:43.117 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:30:43.117 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:30:43.120 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:33:49.860 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:33:49.861 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 14:33:49.861 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:33:49.862 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:33:49.864 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 14:33:49.864 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:33:49.865 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:33:49.867 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:33:49.867 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:33:49.868 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:33:49.871 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:33:49.871 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:33:49.872 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:33:49.873 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_authors
0             10

2025-02-18 14:33:49.873 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 14:33:49.874 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:33:49.874 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:33:49.876 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:33:49.876 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 14:33:49.876 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT authors.first_name || ' ' || authors.last_name AS author_name, 
       (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) AS total_books
FROM authors
WHERE (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) > 1
ORDER BY total_books DESC
2025-02-18 14:33:49.877 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:33:49.878 | INFO     | __main__:execute_queries_from_files:48 - Query results:
       author_name  total_books
0     J.K. Rowling            7
1  Stephenie Meyer            5
2   J.R.R. Tolkien            2

2025-02-18 14:33:49.878 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 14:33:49.885 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT 
    a.first_name, 
    a.last_name, 
    b.title, 
    CAST(b.year_published AS INTEGER) AS year_published
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
2025-02-18 14:33:49.887 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:33:49.889 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title  year_published
0      Harper         Lee                      To Kill a Mockingbird          1960.0
1    F. Scott  Fitzgerald                           The Great Gatsby          1925.0
2      Aldous      Huxley                            Brave New World          1932.0
3        J.D.    Salinger                     The Catcher in the Rye          1951.0
4         Ray    Bradbury                             Fahrenheit 451          1953.0
5        Jane      Austen                        Pride and Prejudice          1813.0
6      J.R.R.     Tolkien                                 The Hobbit          1937.0
7      J.R.R.     Tolkien                      The Lord of the Rings          1954.0
8        J.K.     Rowling    Harry Potter and the Chamber of Secrets          1998.0
9        J.K.     Rowling       Harry Potter and the Deathly Hallows          2007.0
10       J.K.     Rowling        Harry Potter and the Goblet of Fire          2000.0
11       J.K.     Rowling     Harry Potter and the Half-Blood Prince          2005.0
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix          2003.0
13       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban          1999.0
14       J.K.     Rowling      Harry Potter and the Sorcerer's Stone          1997.0
15  Stephenie       Meyer                              Breaking Dawn          2008.0
16  Stephenie       Meyer                                    Eclipse          2007.0
17  Stephenie       Meyer                               Midnight Sun          2020.0
18  Stephenie       Meyer                                   New Moon          2006.0
19  Stephenie       Meyer                                   Twilight          2005.0
20       John        Saul                                       None             NaN

2025-02-18 14:33:49.890 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books and their author sorted by year published
SELECT a.first_name, a.last_name, b.title, b.year_published
FROM authors a
JOIN books b ON a.author_id = b.author_id
ORDER BY b.year_published ASC
2025-02-18 14:33:49.891 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:33:49.893 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title  year_published
0        Jane      Austen                        Pride and Prejudice            1813
1    F. Scott  Fitzgerald                           The Great Gatsby            1925
2      Aldous      Huxley                            Brave New World            1932
3      J.R.R.     Tolkien                                 The Hobbit            1937
4        J.D.    Salinger                     The Catcher in the Rye            1951
5         Ray    Bradbury                             Fahrenheit 451            1953
6      J.R.R.     Tolkien                      The Lord of the Rings            1954
7      Harper         Lee                      To Kill a Mockingbird            1960
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone            1997
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets            1998
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban            1999
11       J.K.     Rowling        Harry Potter and the Goblet of Fire            2000
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix            2003
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince            2005
14  Stephenie       Meyer                                   Twilight            2005
15  Stephenie       Meyer                                   New Moon            2006
16       J.K.     Rowling       Harry Potter and the Deathly Hallows            2007
17  Stephenie       Meyer                                    Eclipse            2007
18  Stephenie       Meyer                              Breaking Dawn            2008
19  Stephenie       Meyer                               Midnight Sun            2020

2025-02-18 14:33:49.893 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 14:33:49.893 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:33:49.894 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:33:49.896 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:33:49.896 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:33:49.897 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:33:49.899 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:40:44.622 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:40:44.623 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 14:40:44.623 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:40:44.624 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:40:44.626 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 14:40:44.626 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:40:44.627 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:40:44.629 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:40:44.629 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:40:44.630 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:40:44.633 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:40:44.633 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of authors in the database
SELECT COUNT(*) AS total_authors
FROM authors
2025-02-18 14:40:44.634 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:40:44.635 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_authors
0             10

2025-02-18 14:40:44.635 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 14:40:44.642 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT 
    a.first_name, 
    a.last_name, 
    (SELECT CAST(MIN(b.year_published) AS INTEGER) FROM books b WHERE b.author_id = a.author_id) AS earliest_year, 
    (SELECT CAST(MAX(b.year_published) AS INTEGER) FROM books b WHERE b.author_id = a.author_id) AS latest_year
FROM authors a
ORDER BY latest_year DESC
2025-02-18 14:40:44.643 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:40:44.645 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:40:44.646 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 14:40:44.646 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT authors.first_name || ' ' || authors.last_name AS author_name, 
       (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) AS total_books
FROM authors
WHERE (SELECT COUNT(*) FROM books WHERE books.author_id = authors.author_id) > 1
ORDER BY total_books DESC
2025-02-18 14:40:44.647 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:40:44.648 | INFO     | __main__:execute_queries_from_files:48 - Query results:
       author_name  total_books
0     J.K. Rowling            7
1  Stephenie Meyer            5
2   J.R.R. Tolkien            2

2025-02-18 14:40:44.649 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 14:40:44.653 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT books.title, name
FROM books
INNER JOIN authors ON books.author_id = authors.author_id
2025-02-18 14:40:44.654 | ERROR    | __main__:execute_sql_query:28 - Unexpected error: Execution failed on sql '-- Get books with their authors
SELECT books.title, name
FROM books
INNER JOIN authors ON books.author_id = authors.author_id': no such column: name
2025-02-18 14:40:44.654 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 14:40:44.655 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:40:44.655 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:40:44.657 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:40:44.657 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:40:44.658 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:40:44.660 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:45:55.301 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:45:55.301 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 14:45:55.309 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:45:55.310 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:45:55.313 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 14:45:55.313 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:45:55.314 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:45:55.316 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:45:55.316 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Find the earliest and latest year of publication
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year, 
       MAX(b.year_published) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:45:55.317 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:45:55.319 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:45:55.320 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 14:45:55.320 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT 
    a.first_name, 
    a.last_name, 
    (SELECT CAST(MIN(b.year_published) AS INTEGER) FROM books b WHERE b.author_id = a.author_id) AS earliest_year, 
    (SELECT CAST(MAX(b.year_published) AS INTEGER) FROM books b WHERE b.author_id = a.author_id) AS latest_year
FROM authors a
ORDER BY latest_year DESC
2025-02-18 14:45:55.321 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:45:55.323 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:45:55.324 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 14:45:55.329 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 14:45:55.330 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:45:55.332 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 14:45:55.333 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 14:45:55.337 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 14:45:55.338 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:45:55.340 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title
0      Harper         Lee                      To Kill a Mockingbird
1    F. Scott  Fitzgerald                           The Great Gatsby
2      Aldous      Huxley                            Brave New World
3        J.D.    Salinger                     The Catcher in the Rye
4         Ray    Bradbury                             Fahrenheit 451
5        Jane      Austen                        Pride and Prejudice
6      J.R.R.     Tolkien                                 The Hobbit
7      J.R.R.     Tolkien                      The Lord of the Rings
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban
11       J.K.     Rowling        Harry Potter and the Goblet of Fire
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince
14       J.K.     Rowling       Harry Potter and the Deathly Hallows
15  Stephenie       Meyer                                   Twilight
16  Stephenie       Meyer                                   New Moon
17  Stephenie       Meyer                                    Eclipse
18  Stephenie       Meyer                              Breaking Dawn
19  Stephenie       Meyer                               Midnight Sun

2025-02-18 14:45:55.341 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 14:45:55.341 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:45:55.342 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:45:55.343 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:45:55.343 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:45:55.344 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:45:55.346 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:53:45.843 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:53:45.843 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 14:53:45.849 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:53:45.851 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:53:45.854 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 14:53:45.854 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:53:45.855 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:53:45.857 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:53:45.857 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Find the earliest and latest year of publication
SELECT 
    a.first_name, 
    a.last_name, 
    CAST(MIN(b.year_published) AS INTEGER) AS earliest_year, 
    CAST(MAX(b.year_published) AS INTEGER) AS latest_year
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
2025-02-18 14:53:45.858 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:53:45.862 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:53:45.863 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 14:53:45.869 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT 
    a.first_name, 
    a.last_name, 
    CAST((SELECT MIN(b.year_published) FROM books b WHERE b.author_id = a.author_id) AS INTEGER) AS earliest_year, 
    CAST((SELECT MAX(b.year_published) FROM books b WHERE b.author_id = a.author_id) AS INTEGER) AS latest_year
FROM authors a
ORDER BY latest_year DESC
2025-02-18 14:53:45.871 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:53:45.874 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:53:45.875 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 14:53:45.875 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 14:53:45.877 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:53:45.880 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 14:53:45.880 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 14:53:45.881 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 14:53:45.882 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:53:45.883 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title
0      Harper         Lee                      To Kill a Mockingbird
1    F. Scott  Fitzgerald                           The Great Gatsby
2      Aldous      Huxley                            Brave New World
3        J.D.    Salinger                     The Catcher in the Rye
4         Ray    Bradbury                             Fahrenheit 451
5        Jane      Austen                        Pride and Prejudice
6      J.R.R.     Tolkien                                 The Hobbit
7      J.R.R.     Tolkien                      The Lord of the Rings
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban
11       J.K.     Rowling        Harry Potter and the Goblet of Fire
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince
14       J.K.     Rowling       Harry Potter and the Deathly Hallows
15  Stephenie       Meyer                                   Twilight
16  Stephenie       Meyer                                   New Moon
17  Stephenie       Meyer                                    Eclipse
18  Stephenie       Meyer                              Breaking Dawn
19  Stephenie       Meyer                               Midnight Sun

2025-02-18 14:53:45.884 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 14:53:45.884 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:53:45.886 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:53:45.888 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:53:45.888 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:53:45.890 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:53:45.892 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:56:01.184 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:56:01.185 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 14:56:01.191 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:56:01.193 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:56:01.196 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 14:56:01.196 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:56:01.197 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:56:01.199 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:56:01.200 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Find the earliest and latest year of publication
SELECT 
    a.first_name, 
    a.last_name, 
    CAST((SELECT MIN(b.year_published) FROM books b WHERE b.author_id = a.author_id) AS INTEGER) AS earliest_year, 
    CAST((SELECT MAX(b.year_published) FROM books b WHERE b.author_id = a.author_id) AS INTEGER) AS latest_year
FROM authors a
ORDER BY latest_year DESC
2025-02-18 14:56:01.201 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:56:01.204 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  earliest_year  latest_year
0  Stephenie       Meyer         2005.0       2020.0
1       J.K.     Rowling         1997.0       2007.0
2     Harper         Lee         1960.0       1960.0
3     J.R.R.     Tolkien         1937.0       1954.0
4        Ray    Bradbury         1953.0       1953.0
5       J.D.    Salinger         1951.0       1951.0
6     Aldous      Huxley         1932.0       1932.0
7   F. Scott  Fitzgerald         1925.0       1925.0
8       Jane      Austen         1813.0       1813.0
9       John        Saul            NaN          NaN

2025-02-18 14:56:01.204 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 14:56:01.206 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:56:01.207 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:56:01.209 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:56:01.209 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 14:56:01.209 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 14:56:01.211 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:56:01.213 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 14:56:01.214 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 14:56:01.214 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 14:56:01.215 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:56:01.217 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title
0      Harper         Lee                      To Kill a Mockingbird
1    F. Scott  Fitzgerald                           The Great Gatsby
2      Aldous      Huxley                            Brave New World
3        J.D.    Salinger                     The Catcher in the Rye
4         Ray    Bradbury                             Fahrenheit 451
5        Jane      Austen                        Pride and Prejudice
6      J.R.R.     Tolkien                                 The Hobbit
7      J.R.R.     Tolkien                      The Lord of the Rings
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban
11       J.K.     Rowling        Harry Potter and the Goblet of Fire
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince
14       J.K.     Rowling       Harry Potter and the Deathly Hallows
15  Stephenie       Meyer                                   Twilight
16  Stephenie       Meyer                                   New Moon
17  Stephenie       Meyer                                    Eclipse
18  Stephenie       Meyer                              Breaking Dawn
19  Stephenie       Meyer                               Midnight Sun

2025-02-18 14:56:01.217 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 14:56:01.218 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:56:01.219 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:56:01.221 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:56:01.222 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:56:01.223 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:56:01.224 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 14:59:34.244 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 14:59:34.244 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 14:59:34.251 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 14:59:34.253 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:59:34.256 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 14:59:34.257 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 14:59:34.258 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:59:34.261 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 14:59:34.261 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Earliest and Newest Published Book
SELECT a.first_name, a.last_name, 
       MIN(b.year_published) AS earliest_year,
       MAX(b.year_published) AS latest_year
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY latest_year DESC
LIMIT 1
2025-02-18 14:59:34.262 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:59:34.264 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  earliest_year  latest_year
0  Stephenie     Meyer           2005         2020

2025-02-18 14:59:34.264 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Median Published Book
WITH YearRanked AS (
    SELECT b.year_published
    FROM books b
    ORDER BY b.year_published
),
Median AS (
    SELECT year_published,
           ROW_NUMBER() OVER () AS row_num,
           COUNT(*) OVER () AS total_rows
    FROM YearRanked
)
SELECT year_published
FROM Median
WHERE row_num IN (total_rows / 2, total_rows / 2 + 1)
LIMIT 1
2025-02-18 14:59:34.265 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:59:34.267 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   year_published
0            1998

2025-02-18 14:59:34.267 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 14:59:34.268 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 14:59:34.269 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:59:34.271 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 14:59:34.271 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 14:59:34.271 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 14:59:34.273 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:59:34.276 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 14:59:34.277 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 14:59:34.277 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 14:59:34.278 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:59:34.281 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title
0      Harper         Lee                      To Kill a Mockingbird
1    F. Scott  Fitzgerald                           The Great Gatsby
2      Aldous      Huxley                            Brave New World
3        J.D.    Salinger                     The Catcher in the Rye
4         Ray    Bradbury                             Fahrenheit 451
5        Jane      Austen                        Pride and Prejudice
6      J.R.R.     Tolkien                                 The Hobbit
7      J.R.R.     Tolkien                      The Lord of the Rings
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban
11       J.K.     Rowling        Harry Potter and the Goblet of Fire
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince
14       J.K.     Rowling       Harry Potter and the Deathly Hallows
15  Stephenie       Meyer                                   Twilight
16  Stephenie       Meyer                                   New Moon
17  Stephenie       Meyer                                    Eclipse
18  Stephenie       Meyer                              Breaking Dawn
19  Stephenie       Meyer                               Midnight Sun

2025-02-18 14:59:34.281 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 14:59:34.282 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 14:59:34.284 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:59:34.286 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 14:59:34.287 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 14:59:34.288 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 14:59:34.290 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 15:02:01.955 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 15:02:01.955 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 15:02:01.961 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 15:02:01.963 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:02:01.966 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 15:02:01.966 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 15:02:01.967 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:02:01.969 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 15:02:01.969 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Earliest and Newest Published Book
SELECT 
    a.first_name,
    a.last_name,
    MIN(b.year_published) AS earliest_year,
    MAX(b.year_published) AS latest_year
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY earliest_year ASC, latest_year DESC
LIMIT 1
2025-02-18 15:02:01.970 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:02:01.973 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  earliest_year  latest_year
0       Jane    Austen           1813         1813

2025-02-18 15:02:01.973 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 15:02:01.973 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 15:02:01.974 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:02:01.976 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 15:02:01.977 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 15:02:01.977 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 15:02:01.978 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:02:01.980 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 15:02:01.981 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 15:02:01.981 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 15:02:01.983 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:02:01.985 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title
0      Harper         Lee                      To Kill a Mockingbird
1    F. Scott  Fitzgerald                           The Great Gatsby
2      Aldous      Huxley                            Brave New World
3        J.D.    Salinger                     The Catcher in the Rye
4         Ray    Bradbury                             Fahrenheit 451
5        Jane      Austen                        Pride and Prejudice
6      J.R.R.     Tolkien                                 The Hobbit
7      J.R.R.     Tolkien                      The Lord of the Rings
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban
11       J.K.     Rowling        Harry Potter and the Goblet of Fire
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince
14       J.K.     Rowling       Harry Potter and the Deathly Hallows
15  Stephenie       Meyer                                   Twilight
16  Stephenie       Meyer                                   New Moon
17  Stephenie       Meyer                                    Eclipse
18  Stephenie       Meyer                              Breaking Dawn
19  Stephenie       Meyer                               Midnight Sun

2025-02-18 15:02:01.986 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 15:02:01.986 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 15:02:01.987 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:02:01.990 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 15:02:01.990 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 15:02:01.991 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:02:01.993 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 15:04:51.569 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 15:04:51.569 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 15:04:51.576 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 15:04:51.577 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:04:51.580 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 15:04:51.580 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 15:04:51.581 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:04:51.583 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 15:04:51.584 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Earliest Published Book
SELECT 
    a.first_name,
    a.last_name,
    MIN(b.year_published) AS earliest_year,
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY earliest_year ASC, latest_year DESC
LIMIT 1
2025-02-18 15:04:51.584 | ERROR    | __main__:execute_sql_query:28 - Unexpected error: Execution failed on sql '-- Earliest Published Book
SELECT 
    a.first_name,
    a.last_name,
    MIN(b.year_published) AS earliest_year,
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY earliest_year ASC, latest_year DESC
LIMIT 1': near "FROM": syntax error
2025-02-18 15:04:51.584 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Latest Published Book
SELECT 
    a.first_name,
    a.last_name,
    MAX(b.year_published) AS earliest_year,
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY earliest_year ASC, latest_year DESC
LIMIT 1
2025-02-18 15:04:51.585 | ERROR    | __main__:execute_sql_query:28 - Unexpected error: Execution failed on sql '-- Latest Published Book
SELECT 
    a.first_name,
    a.last_name,
    MAX(b.year_published) AS earliest_year,
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY earliest_year ASC, latest_year DESC
LIMIT 1': near "FROM": syntax error
2025-02-18 15:04:51.585 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 15:04:51.585 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 15:04:51.586 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:04:51.588 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 15:04:51.588 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 15:04:51.589 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 15:04:51.590 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:04:51.592 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 15:04:51.593 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 15:04:51.593 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 15:04:51.594 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:04:51.596 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title
0      Harper         Lee                      To Kill a Mockingbird
1    F. Scott  Fitzgerald                           The Great Gatsby
2      Aldous      Huxley                            Brave New World
3        J.D.    Salinger                     The Catcher in the Rye
4         Ray    Bradbury                             Fahrenheit 451
5        Jane      Austen                        Pride and Prejudice
6      J.R.R.     Tolkien                                 The Hobbit
7      J.R.R.     Tolkien                      The Lord of the Rings
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban
11       J.K.     Rowling        Harry Potter and the Goblet of Fire
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince
14       J.K.     Rowling       Harry Potter and the Deathly Hallows
15  Stephenie       Meyer                                   Twilight
16  Stephenie       Meyer                                   New Moon
17  Stephenie       Meyer                                    Eclipse
18  Stephenie       Meyer                              Breaking Dawn
19  Stephenie       Meyer                               Midnight Sun

2025-02-18 15:04:51.597 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 15:04:51.597 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 15:04:51.599 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:04:51.601 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 15:04:51.601 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 15:04:51.602 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:04:51.605 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 15:06:38.991 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 15:06:38.992 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 15:06:38.998 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 15:06:38.999 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:06:39.003 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 15:06:39.003 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 15:06:39.004 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:06:39.006 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            0

2025-02-18 15:06:39.006 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Earliest Published Book
SELECT title, year_published
FROM books
ORDER BY year_published ASC
LIMIT 1
2025-02-18 15:06:39.007 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:06:39.009 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                 title  year_published
0  Pride and Prejudice            1813

2025-02-18 15:06:39.009 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 15:06:39.010 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 15:06:39.011 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:06:39.013 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 15:06:39.014 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 15:06:39.014 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 15:06:39.015 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:06:39.019 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 15:06:39.019 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 15:06:39.020 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 15:06:39.021 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:06:39.023 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title
0      Harper         Lee                      To Kill a Mockingbird
1    F. Scott  Fitzgerald                           The Great Gatsby
2      Aldous      Huxley                            Brave New World
3        J.D.    Salinger                     The Catcher in the Rye
4         Ray    Bradbury                             Fahrenheit 451
5        Jane      Austen                        Pride and Prejudice
6      J.R.R.     Tolkien                                 The Hobbit
7      J.R.R.     Tolkien                      The Lord of the Rings
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban
11       J.K.     Rowling        Harry Potter and the Goblet of Fire
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince
14       J.K.     Rowling       Harry Potter and the Deathly Hallows
15  Stephenie       Meyer                                   Twilight
16  Stephenie       Meyer                                   New Moon
17  Stephenie       Meyer                                    Eclipse
18  Stephenie       Meyer                              Breaking Dawn
19  Stephenie       Meyer                               Midnight Sun

2025-02-18 15:06:39.024 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 15:06:39.024 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 15:06:39.025 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:06:39.028 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 15:06:39.028 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 15:06:39.029 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:06:39.031 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 The Hobbit     J.R.R.     Tolkien
19                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 15:11:46.543 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 15:11:46.543 | INFO     | __main__:main:49 - Database operation started.
2025-02-18 15:11:46.548 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 15:11:46.554 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 15:11:46.564 | INFO     | __main__:insert_data:40 - Data inserted successfully.
2025-02-18 15:11:46.564 | INFO     | __main__:main:52 - Database operation completed.
2025-02-18 15:12:02.510 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 15:12:02.511 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 15:12:02.511 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 15:12:02.520 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 15:12:02.532 | ERROR    | __main__:execute_sql_file:30 - SQLite error in C:\Projects\datafun-05-sql\sql_features\update_records.sql: table books has no column named genre
2025-02-18 15:12:02.532 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 15:12:02.532 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 15:12:41.381 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 15:12:41.381 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 15:12:41.383 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 15:12:41.384 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 15:12:41.396 | ERROR    | __main__:execute_sql_file:30 - SQLite error in C:\Projects\datafun-05-sql\sql_features\update_records.sql: UNIQUE constraint failed: authors.author_id
2025-02-18 15:12:41.397 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 15:12:41.397 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 15:12:50.103 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 15:12:50.103 | INFO     | __main__:main:49 - Database operation started.
2025-02-18 15:12:50.108 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 15:12:50.114 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 15:12:50.120 | INFO     | __main__:insert_data:40 - Data inserted successfully.
2025-02-18 15:12:50.120 | INFO     | __main__:main:52 - Database operation completed.
2025-02-18 15:12:56.040 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 15:12:56.041 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 15:12:56.042 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 15:12:56.049 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 15:12:56.071 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\update_records.sql
2025-02-18 15:12:56.071 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 15:12:56.071 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 15:13:04.879 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 15:13:04.880 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 15:13:04.880 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 15:13:04.882 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:13:04.887 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 15:13:04.887 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 15:13:04.889 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:13:04.891 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            1

2025-02-18 15:13:04.891 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Earliest Published Book
SELECT title, year_published
FROM books
ORDER BY year_published ASC
LIMIT 1
2025-02-18 15:13:04.893 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:13:04.895 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                 title  year_published
0  Pride and Prejudice            1813

2025-02-18 15:13:04.896 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 15:13:04.896 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 15:13:04.898 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:13:04.902 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 15:13:04.902 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 15:13:04.903 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 15:13:04.904 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:13:04.909 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 15:13:04.909 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 15:13:04.910 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 15:13:04.912 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:13:04.919 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title
0      Harper         Lee                      To Kill a Mockingbird
1    F. Scott  Fitzgerald                           The Great Gatsby
2      Aldous      Huxley                            Brave New World
3        J.D.    Salinger                     The Catcher in the Rye
4         Ray    Bradbury                             Fahrenheit 451
5        Jane      Austen                        Pride and Prejudice
6      J.R.R.     Tolkien                                 The Hobbit
7      J.R.R.     Tolkien                      The Lord of the Rings
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban
11       J.K.     Rowling        Harry Potter and the Goblet of Fire
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince
14       J.K.     Rowling       Harry Potter and the Deathly Hallows
15  Stephenie       Meyer                                   Twilight
16  Stephenie       Meyer                                   New Moon
17  Stephenie       Meyer                                    Eclipse
18  Stephenie       Meyer                              Breaking Dawn
19  Stephenie       Meyer                               Midnight Sun
20       John        Saul                                 Nightshade

2025-02-18 15:13:04.920 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 15:13:04.920 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 15:13:04.922 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:13:04.927 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 15:13:04.927 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 15:13:04.930 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:13:04.935 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 Nightshade       John        Saul
19                                 The Hobbit     J.R.R.     Tolkien
20                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 15:43:49.731 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 15:43:49.732 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 15:43:49.733 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 15:43:49.734 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:43:49.738 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           21

2025-02-18 15:43:49.738 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 15:43:49.740 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:43:49.743 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name   last_name  total_books
0       J.K.     Rowling            7
1  Stephenie       Meyer            5
2     J.R.R.     Tolkien            2
3        Ray    Bradbury            1
4     Harper         Lee            1
5       Jane      Austen            1
6     Aldous      Huxley            1
7       J.D.    Salinger            1
8   F. Scott  Fitzgerald            1
9       John        Saul            1

2025-02-18 15:43:49.744 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Earliest Published Book
SELECT title, year_published
FROM books
ORDER BY year_published ASC
LIMIT 1
2025-02-18 15:43:49.746 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:43:49.786 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                 title  year_published
0  Pride and Prejudice            1813

2025-02-18 15:43:49.788 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 15:43:49.790 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 15:43:49.792 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:43:49.799 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 15:43:49.804 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 15:43:49.805 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 15:43:49.809 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:43:49.817 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 15:43:49.817 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 15:43:49.818 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 15:43:49.819 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:43:49.823 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   first_name   last_name                                      title
0      Harper         Lee                      To Kill a Mockingbird
1    F. Scott  Fitzgerald                           The Great Gatsby
2      Aldous      Huxley                            Brave New World
3        J.D.    Salinger                     The Catcher in the Rye
4         Ray    Bradbury                             Fahrenheit 451
5        Jane      Austen                        Pride and Prejudice
6      J.R.R.     Tolkien                                 The Hobbit
7      J.R.R.     Tolkien                      The Lord of the Rings
8        J.K.     Rowling      Harry Potter and the Sorcerer's Stone
9        J.K.     Rowling    Harry Potter and the Chamber of Secrets
10       J.K.     Rowling   Harry Potter and the Prisoner of Azkaban
11       J.K.     Rowling        Harry Potter and the Goblet of Fire
12       J.K.     Rowling  Harry Potter and the Order of the Pheonix
13       J.K.     Rowling     Harry Potter and the Half-Blood Prince
14       J.K.     Rowling       Harry Potter and the Deathly Hallows
15  Stephenie       Meyer                                   Twilight
16  Stephenie       Meyer                                   New Moon
17  Stephenie       Meyer                                    Eclipse
18  Stephenie       Meyer                              Breaking Dawn
19  Stephenie       Meyer                               Midnight Sun
20       John        Saul                                 Nightshade

2025-02-18 15:43:49.825 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 15:43:49.825 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 15:43:49.827 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:43:49.831 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title  year_published
0                         Pride and Prejudice            1813
1                            The Great Gatsby            1925
2                             Brave New World            1932
3                                  The Hobbit            1937
4                      The Catcher in the Rye            1951
5                              Fahrenheit 451            1953
6                       The Lord of the Rings            1954
7                       To Kill a Mockingbird            1960
8       Harry Potter and the Sorcerer's Stone            1997
9     Harry Potter and the Chamber of Secrets            1998
10   Harry Potter and the Prisoner of Azkaban            1999
11        Harry Potter and the Goblet of Fire            2000
12                                 Nightshade            2000
13  Harry Potter and the Order of the Pheonix            2003
14     Harry Potter and the Half-Blood Prince            2005
15                                   Twilight            2005
16                                   New Moon            2006
17       Harry Potter and the Deathly Hallows            2007
18                                    Eclipse            2007
19                              Breaking Dawn            2008
20                               Midnight Sun            2020

2025-02-18 15:43:49.832 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 15:43:49.834 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 15:43:49.839 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                        title first_name   last_name
0                         Pride and Prejudice       Jane      Austen
1                              Fahrenheit 451        Ray    Bradbury
2                            The Great Gatsby   F. Scott  Fitzgerald
3                             Brave New World     Aldous      Huxley
4                       To Kill a Mockingbird     Harper         Lee
5                                    Twilight  Stephenie       Meyer
6                                    New Moon  Stephenie       Meyer
7                                     Eclipse  Stephenie       Meyer
8                               Breaking Dawn  Stephenie       Meyer
9                                Midnight Sun  Stephenie       Meyer
10      Harry Potter and the Sorcerer's Stone       J.K.     Rowling
11    Harry Potter and the Chamber of Secrets       J.K.     Rowling
12   Harry Potter and the Prisoner of Azkaban       J.K.     Rowling
13        Harry Potter and the Goblet of Fire       J.K.     Rowling
14  Harry Potter and the Order of the Pheonix       J.K.     Rowling
15     Harry Potter and the Half-Blood Prince       J.K.     Rowling
16       Harry Potter and the Deathly Hallows       J.K.     Rowling
17                     The Catcher in the Rye       J.D.    Salinger
18                                 Nightshade       John        Saul
19                                 The Hobbit     J.R.R.     Tolkien
20                      The Lord of the Rings     J.R.R.     Tolkien

2025-02-18 18:27:40.788 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 18:27:40.789 | INFO     | __main__:main:49 - Database operation started.
2025-02-18 18:27:40.794 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 18:27:40.800 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 18:27:40.806 | INFO     | __main__:insert_data:40 - Data inserted successfully.
2025-02-18 18:27:40.806 | INFO     | __main__:main:52 - Database operation completed.
2025-02-18 18:27:51.276 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 18:27:51.276 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 18:27:51.277 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 18:27:51.283 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 18:27:51.297 | ERROR    | __main__:execute_sql_file:30 - SQLite error in C:\Projects\datafun-05-sql\sql_features\update_records.sql: UNIQUE constraint failed: books.book_id
2025-02-18 18:27:51.297 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 18:27:51.297 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 18:29:47.822 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 18:29:47.822 | INFO     | __main__:main:49 - Database operation started.
2025-02-18 18:29:47.828 | INFO     | __main__:create_database:20 - Tables dropped successfully.
2025-02-18 18:29:47.833 | INFO     | __main__:create_database:28 - Tables created successfully.
2025-02-18 18:29:47.838 | INFO     | __main__:insert_data:40 - Data inserted successfully.
2025-02-18 18:29:47.839 | INFO     | __main__:main:52 - Database operation completed.
2025-02-18 18:29:54.328 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 18:29:54.328 | INFO     | __main__:main:38 - Starting feature queries execution...
2025-02-18 18:29:54.329 | INFO     | __main__:main:53 - Connected to database: C:\Projects\datafun-05-sql\project.sqlite3
2025-02-18 18:29:54.336 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\delete_records.sql
2025-02-18 18:29:54.365 | INFO     | __main__:execute_sql_file:28 - Executed: C:\Projects\datafun-05-sql\sql_features\update_records.sql
2025-02-18 18:29:54.365 | INFO     | __main__:main:59 - Feature queries execution completed successfully.
2025-02-18 18:29:54.366 | INFO     | __main__:main:64 - Database connection closed.
2025-02-18 18:30:02.069 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 18:30:02.069 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 18:30:02.070 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 18:30:02.075 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:30:02.080 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           29

2025-02-18 18:30:02.080 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 18:30:02.082 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:30:02.084 | INFO     | __main__:execute_queries_from_files:48 - Query results:
     first_name   last_name  total_books
0          J.K.     Rowling            7
1     Stephenie       Meyer            5
2        J.R.R.     Tolkien            2
3      Richelle        Mead            1
4           Ray    Bradbury            1
5        Harper         Lee            1
6         Emily        Snow            1
7          Mary      Kubica            1
8          Jane      Austen            1
9          Dean      Koontz            1
10         V.C.     Andrews            1
11       Aldous      Huxley            1
12         J.D.    Salinger            1
13      Stephen        King            1
14  Edgar Allan         Poe            1
15     F. Scott  Fitzgerald            1
16         John        Saul            1
17     Nicholas      Sparks            0

2025-02-18 18:30:02.084 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Earliest Published Book
SELECT title, year_published
FROM books
ORDER BY year_published ASC
LIMIT 1
2025-02-18 18:30:02.085 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:30:02.087 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                 title  year_published
0  Pride and Prejudice            1813

2025-02-18 18:30:02.087 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 18:30:02.088 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 18:30:02.088 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:30:02.090 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 18:30:02.090 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 18:30:02.090 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 18:30:02.093 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:30:02.095 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 18:30:02.096 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 18:30:02.096 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 18:30:02.097 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:30:02.099 | INFO     | __main__:execute_queries_from_files:48 - Query results:
     first_name   last_name                                            title
0        Harper         Lee                            To Kill a Mockingbird
1      F. Scott  Fitzgerald                                 The Great Gatsby
2        Aldous      Huxley                                  Brave New World
3          J.D.    Salinger                           The Catcher in the Rye
4           Ray    Bradbury                                   Fahrenheit 451
5          Jane      Austen                              Pride and Prejudice
6        J.R.R.     Tolkien                                       The Hobbit
7        J.R.R.     Tolkien                            The Lord of the Rings
8          J.K.     Rowling            Harry Potter and the Sorcerer's Stone
9          J.K.     Rowling          Harry Potter and the Chamber of Secrets
10         J.K.     Rowling         Harry Potter and the Prisoner of Azkaban
11         J.K.     Rowling              Harry Potter and the Goblet of Fire
12         J.K.     Rowling        Harry Potter and the Order of the Pheonix
13         J.K.     Rowling           Harry Potter and the Half-Blood Prince
14         J.K.     Rowling             Harry Potter and the Deathly Hallows
15    Stephenie       Meyer                                         Twilight
16    Stephenie       Meyer                                         New Moon
17    Stephenie       Meyer                                          Eclipse
18    Stephenie       Meyer                                    Breaking Dawn
19    Stephenie       Meyer                                     Midnight Sun
20         John        Saul                                       Nightshade
21     Richelle        Mead                                  Vampire Academy
22         V.C.     Andrews                             Flowers in the Attic
23  Edgar Allan         Poe  The Complete Tales and Poems of Edgar Allan Poe
24      Stephen        King                                               IT
25         Mary      Kubica                                      Pretty Baby
26        Emily        Snow                                         Devoured
27         Dean      Koontz                                         Watchers

2025-02-18 18:30:02.100 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 18:30:02.100 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 18:30:02.101 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:30:02.103 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                              title  year_published
0                               Pride and Prejudice            1813
1                                  The Great Gatsby            1925
2                                   Brave New World            1932
3                                        The Hobbit            1937
4                            The Catcher in the Rye            1951
5                                    Fahrenheit 451            1953
6                             The Lord of the Rings            1954
7                             To Kill a Mockingbird            1960
8                              Flowers in the Attic            1979
9                                                IT            1986
10                                         Watchers            1987
11                                     The Notebook            1996
12            Harry Potter and the Sorcerer's Stone            1997
13          Harry Potter and the Chamber of Secrets            1998
14         Harry Potter and the Prisoner of Azkaban            1999
15              Harry Potter and the Goblet of Fire            2000
16                                       Nightshade            2000
17        Harry Potter and the Order of the Pheonix            2003
18           Harry Potter and the Half-Blood Prince            2005
19                                         Twilight            2005
20                                         New Moon            2006
21             Harry Potter and the Deathly Hallows            2007
22                                          Eclipse            2007
23                                  Vampire Academy            2007
24  The Complete Tales and Poems of Edgar Allan Poe            2007
25                                    Breaking Dawn            2008
26                                         Devoured            2013
27                                      Pretty Baby            2015
28                                     Midnight Sun            2020

2025-02-18 18:30:02.104 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 18:30:02.105 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:30:02.107 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                              title   first_name   last_name
0                              Flowers in the Attic         V.C.     Andrews
1                               Pride and Prejudice         Jane      Austen
2                                    Fahrenheit 451          Ray    Bradbury
3                                  The Great Gatsby     F. Scott  Fitzgerald
4                                   Brave New World       Aldous      Huxley
5                                                IT      Stephen        King
6                                          Watchers         Dean      Koontz
7                                       Pretty Baby         Mary      Kubica
8                             To Kill a Mockingbird       Harper         Lee
9                                   Vampire Academy     Richelle        Mead
10                                         Twilight    Stephenie       Meyer
11                                         New Moon    Stephenie       Meyer
12                                          Eclipse    Stephenie       Meyer
13                                    Breaking Dawn    Stephenie       Meyer
14                                     Midnight Sun    Stephenie       Meyer
15  The Complete Tales and Poems of Edgar Allan Poe  Edgar Allan         Poe
16            Harry Potter and the Sorcerer's Stone         J.K.     Rowling
17          Harry Potter and the Chamber of Secrets         J.K.     Rowling
18         Harry Potter and the Prisoner of Azkaban         J.K.     Rowling
19              Harry Potter and the Goblet of Fire         J.K.     Rowling
20        Harry Potter and the Order of the Pheonix         J.K.     Rowling
21           Harry Potter and the Half-Blood Prince         J.K.     Rowling
22             Harry Potter and the Deathly Hallows         J.K.     Rowling
23                           The Catcher in the Rye         J.D.    Salinger
24                                       Nightshade         John        Saul
25                                         Devoured        Emily        Snow
26                                       The Hobbit       J.R.R.     Tolkien
27                            The Lord of the Rings       J.R.R.     Tolkien

2025-02-18 18:31:44.688 | INFO     | utils_logger:<module>:41 - Logging to file: logs\project_log.log
2025-02-18 18:31:44.688 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_aggregation.sql
2025-02-18 18:31:44.689 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Count the number of books in the database
SELECT COUNT(*) AS total_books
FROM books
2025-02-18 18:31:44.690 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:31:44.693 | INFO     | __main__:execute_queries_from_files:48 - Query results:
   total_books
0           29

2025-02-18 18:31:44.693 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Calculate the number of books by each author
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
LEFT JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
ORDER BY total_books DESC
2025-02-18 18:31:44.694 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:31:44.696 | INFO     | __main__:execute_queries_from_files:48 - Query results:
     first_name   last_name  total_books
0          J.K.     Rowling            7
1     Stephenie       Meyer            5
2        J.R.R.     Tolkien            2
3      Richelle        Mead            1
4           Ray    Bradbury            1
5        Harper         Lee            1
6         Emily        Snow            1
7          Mary      Kubica            1
8          Jane      Austen            1
9          Dean      Koontz            1
10         V.C.     Andrews            1
11       Aldous      Huxley            1
12         J.D.    Salinger            1
13      Stephen        King            1
14  Edgar Allan         Poe            1
15     F. Scott  Fitzgerald            1
16         John        Saul            1
17     Nicholas      Sparks            0

2025-02-18 18:31:44.696 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Earliest Published Book
SELECT title, year_published
FROM books
ORDER BY year_published ASC
LIMIT 1
2025-02-18 18:31:44.697 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:31:44.699 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                 title  year_published
0  Pride and Prejudice            1813

2025-02-18 18:31:44.699 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_filter.sql
2025-02-18 18:31:44.700 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Filter authors with more than one book
SELECT a.first_name, a.last_name, COUNT(b.book_id) AS total_books
FROM authors a
JOIN books b ON a.author_id = b.author_id
GROUP BY a.author_id
HAVING COUNT(b.book_id) > 1
2025-02-18 18:31:44.701 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:31:44.702 | INFO     | __main__:execute_queries_from_files:48 - Query results:
  first_name last_name  total_books
0     J.R.R.   Tolkien            2
1       J.K.   Rowling            7
2  Stephenie     Meyer            5

2025-02-18 18:31:44.702 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_group_by.sql
2025-02-18 18:31:44.703 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Group books by author
SELECT * FROM books WHERE author_ID = '9e220224-8436-4190-8ad0-e288980693f7'
2025-02-18 18:31:44.704 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:31:44.707 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                book_id          title  year_published                             author_id        genre
0  f91447c8-e02b-4563-a163-396c37e5dcc1       Twilight            2005  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
1  cbb39c2d-d69a-4280-aeb6-00d13d746d3f       New Moon            2006  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
2  1f2b6578-d06b-4c90-b44e-f1c212178fd6        Eclipse            2007  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
3  955ac168-f76f-441b-8d93-d0e188c79034  Breaking Dawn            2008  9e220224-8436-4190-8ad0-e288980693f7  Young Adult
4  629a0c8c-17a1-4ca0-83c2-2bafd1efb958   Midnight Sun            2020  9e220224-8436-4190-8ad0-e288980693f7  Young Adult

2025-02-18 18:31:44.707 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_join.sql
2025-02-18 18:31:44.707 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get books with their authors
SELECT authors.first_name, authors.last_name, books.title
FROM authors
INNER JOIN books ON authors.author_id = books.author_id
2025-02-18 18:31:44.709 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:31:44.711 | INFO     | __main__:execute_queries_from_files:48 - Query results:
     first_name   last_name                                            title
0        Harper         Lee                            To Kill a Mockingbird
1      F. Scott  Fitzgerald                                 The Great Gatsby
2        Aldous      Huxley                                  Brave New World
3          J.D.    Salinger                           The Catcher in the Rye
4           Ray    Bradbury                                   Fahrenheit 451
5          Jane      Austen                              Pride and Prejudice
6        J.R.R.     Tolkien                                       The Hobbit
7        J.R.R.     Tolkien                            The Lord of the Rings
8          J.K.     Rowling            Harry Potter and the Sorcerer's Stone
9          J.K.     Rowling          Harry Potter and the Chamber of Secrets
10         J.K.     Rowling         Harry Potter and the Prisoner of Azkaban
11         J.K.     Rowling              Harry Potter and the Goblet of Fire
12         J.K.     Rowling        Harry Potter and the Order of the Pheonix
13         J.K.     Rowling           Harry Potter and the Half-Blood Prince
14         J.K.     Rowling             Harry Potter and the Deathly Hallows
15    Stephenie       Meyer                                         Twilight
16    Stephenie       Meyer                                         New Moon
17    Stephenie       Meyer                                          Eclipse
18    Stephenie       Meyer                                    Breaking Dawn
19    Stephenie       Meyer                                     Midnight Sun
20         John        Saul                                       Nightshade
21     Richelle        Mead                                  Vampire Academy
22         V.C.     Andrews                             Flowers in the Attic
23  Edgar Allan         Poe  The Complete Tales and Poems of Edgar Allan Poe
24      Stephen        King                                               IT
25         Mary      Kubica                                      Pretty Baby
26        Emily        Snow                                         Devoured
27         Dean      Koontz                                         Watchers

2025-02-18 18:31:44.711 | INFO     | __main__:execute_queries_from_files:35 - Processing file: query_sorting.sql
2025-02-18 18:31:44.712 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Get all books ordered by publication year
SELECT title, year_published
FROM books
ORDER BY year_published ASC
2025-02-18 18:31:44.713 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:31:44.715 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                              title  year_published
0                               Pride and Prejudice            1813
1                                  The Great Gatsby            1925
2                                   Brave New World            1932
3                                        The Hobbit            1937
4                            The Catcher in the Rye            1951
5                                    Fahrenheit 451            1953
6                             The Lord of the Rings            1954
7                             To Kill a Mockingbird            1960
8                              Flowers in the Attic            1979
9                                                IT            1986
10                                         Watchers            1987
11                                     The Notebook            1996
12            Harry Potter and the Sorcerer's Stone            1997
13          Harry Potter and the Chamber of Secrets            1998
14         Harry Potter and the Prisoner of Azkaban            1999
15              Harry Potter and the Goblet of Fire            2000
16                                       Nightshade            2000
17        Harry Potter and the Order of the Pheonix            2003
18           Harry Potter and the Half-Blood Prince            2005
19                                         Twilight            2005
20                                         New Moon            2006
21             Harry Potter and the Deathly Hallows            2007
22                                          Eclipse            2007
23                                  Vampire Academy            2007
24  The Complete Tales and Poems of Edgar Allan Poe            2007
25                                    Breaking Dawn            2008
26                                         Devoured            2013
27                                      Pretty Baby            2015
28                                     Midnight Sun            2020

2025-02-18 18:31:44.716 | INFO     | __main__:execute_queries_from_files:44 - Executing query: -- Sort books by author's last name
SELECT b.title, a.first_name, a.last_name
FROM books b
JOIN authors a ON b.author_id = a.author_id
ORDER BY a.last_name ASC
2025-02-18 18:31:44.717 | INFO     | __main__:execute_sql_query:21 - Query executed successfully.
2025-02-18 18:31:44.719 | INFO     | __main__:execute_queries_from_files:48 - Query results:
                                              title   first_name   last_name
0                              Flowers in the Attic         V.C.     Andrews
1                               Pride and Prejudice         Jane      Austen
2                                    Fahrenheit 451          Ray    Bradbury
3                                  The Great Gatsby     F. Scott  Fitzgerald
4                                   Brave New World       Aldous      Huxley
5                                                IT      Stephen        King
6                                          Watchers         Dean      Koontz
7                                       Pretty Baby         Mary      Kubica
8                             To Kill a Mockingbird       Harper         Lee
9                                   Vampire Academy     Richelle        Mead
10                                         Twilight    Stephenie       Meyer
11                                         New Moon    Stephenie       Meyer
12                                          Eclipse    Stephenie       Meyer
13                                    Breaking Dawn    Stephenie       Meyer
14                                     Midnight Sun    Stephenie       Meyer
15  The Complete Tales and Poems of Edgar Allan Poe  Edgar Allan         Poe
16            Harry Potter and the Sorcerer's Stone         J.K.     Rowling
17          Harry Potter and the Chamber of Secrets         J.K.     Rowling
18         Harry Potter and the Prisoner of Azkaban         J.K.     Rowling
19              Harry Potter and the Goblet of Fire         J.K.     Rowling
20        Harry Potter and the Order of the Pheonix         J.K.     Rowling
21           Harry Potter and the Half-Blood Prince         J.K.     Rowling
22             Harry Potter and the Deathly Hallows         J.K.     Rowling
23                           The Catcher in the Rye         J.D.    Salinger
24                                       Nightshade         John        Saul
25                                         Devoured        Emily        Snow
26                                       The Hobbit       J.R.R.     Tolkien
27                            The Lord of the Rings       J.R.R.     Tolkien

